
{% extends "partials/_layout.html" %} {% include "partials/_header.html" %}
{%block content%}
<!-- User is in session -->
<h2>Welcome, {{ session['user_name'] }}!</h2>

{% include "partials/main_partials/_post.html" %}

<div id = "filter-box" style="width: 70%; margin: 5px auto; 
height: 30px; border: 2px solid white">
<label for="category-select">Filter by Category:</label>
<select id="category-select" onchange="filterPosts()"
style="float: right; padding: 5px; margin-right: 10px">
    <option value="{{ url_for('views.index', category='all') }}">All Posts</option>
    <option value="{{ url_for('views.index', category='related') }}">Most Related</option>
    <option value="{{ url_for('views.index', category='lastest') }}">lastest to earliest</option>
    <option value="{{ url_for('views.index', category='earliest') }}">earliest to lastest</option>
    <!-- Add more options for different categories -->
</select>
</div>

<div id="feed-box" style = "margin-left: 20px; 
width: 100%;
padding: 20px;">

    {% for post in posts %}
    {% with post_data=post %}
        {% include "partials/main_partials/_feed.html" %}
    {% endwith %}    
    {%endfor%}
	
</div>
<div class="modal fade"  id="messagesModal" tabindex="-1" role="dialog" aria-labelledby="messagesModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content" style = "height: 500px" >
            <div class="modal-header">
                <h5 class="modal-title" id="messagesModalLabel">Messages</h5>
            </div>

            <div class="modal-body" >

				<div class="accordion" id="accordionExample">

					{% for message in messages %}
                    <div class="card">
                        <div class="card-header" id="heading{{ message.id }}">
                            <h4 class="mb-0"> 
                                <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse{{ message.id }}" aria-expanded="true" aria-controls="collapse{{ message.id }}">
                                    <span style="color: black;">{{ message.sender.name }}</span>
                                </button>
                            </h4>
                        </div>
                        
                        <div id="collapse{{ message.id }}" class="collapse" aria-labelledby="heading{{ message.id }}" data-parent="#accordionExample">
                            <div class="card-body">
                                {{ message.message_content }}
                            </div>
                        </div>
                    </div>
                    {% endfor %}
					
					
				</div>
       
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<script>
    function filterPosts() {
        var select = document.getElementById("category-select");
        var selectedValue = select.value;

        // Redirect to the dashboard page with the selected category
        window.location.href = selectedValue;
    }
</script>

 {%endblock%}
